import{j as e,A as j,E as g,F as p,G as w,H as b,M as o,N as l,O as c,Q as m,S as i,T as x,U as k,B as f,a5 as E,V as d,W as X,aE as z,aF as I,Z as _,a0 as P,a1 as $,a2 as O,a3 as R,aC as S,a4 as W,aG as G,a6 as u}from"./index-DVk1_3TA.js";import{D as H}from"./delete-modal-B4eS6TOh.js";const L=({control:s})=>e.jsxs(j,{children:[e.jsxs(g,{children:[e.jsx(p,{children:"Basic Details"}),e.jsx(w,{children:"Distributor details"})]}),e.jsx(b,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsx(o,{control:s,name:"name",render:({field:r})=>e.jsxs(l,{children:[e.jsx(c,{className:"text-primary",children:"Name"}),e.jsx(m,{children:e.jsx(i,{placeholder:"Enter full name",className:"w-full",...r})}),e.jsx(x,{})]})}),e.jsx(o,{control:s,name:"destination",render:({field:r})=>e.jsxs(l,{children:[e.jsx(c,{className:"text-primary",children:"Destination"}),e.jsx(m,{children:e.jsx(i,{placeholder:"e.g. Guwahati",className:"w-full",...r})}),e.jsx(x,{})]})})]})})]}),U=({control:s})=>e.jsxs(j,{children:[e.jsx(g,{children:e.jsx(p,{children:"Email"})}),e.jsx(b,{children:e.jsx("div",{className:"grid gap-6",children:e.jsx(o,{control:s,name:"email",render:({field:r})=>e.jsxs(l,{children:[e.jsx(c,{className:"text-primary",children:"Email"}),e.jsx(m,{children:e.jsx(i,{placeholder:"e.g. distributor@domain.com",className:"w-full",type:"email",...r})}),e.jsx(x,{})]})})})})]}),V=({control:s})=>e.jsxs(j,{children:[e.jsxs(g,{children:[e.jsx(p,{children:"Address"}),e.jsx(w,{children:"Distributor office address"})]}),e.jsx(b,{children:e.jsxs("div",{className:"grid gap-6",children:[e.jsx(o,{control:s,name:"address",render:({field:r})=>e.jsxs(l,{className:"grid gap-3 flex-1",children:[e.jsx(c,{className:"text-primary",children:"Office Address"}),e.jsx(m,{children:e.jsx(k,{value:r.value,onChange:r.onChange})}),e.jsx(x,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsx(o,{control:s,name:"state",render:({field:r})=>e.jsxs(l,{children:[e.jsx(c,{className:"text-primary",children:"State"}),e.jsx(m,{children:e.jsx(i,{placeholder:"e.g. Assam",className:"w-full",...r})}),e.jsx(x,{})]})}),e.jsx(o,{control:s,name:"phone",render:({field:r})=>e.jsxs(l,{children:[e.jsx(c,{className:"text-primary",children:"Phone Number"}),e.jsx(m,{children:e.jsx(i,{placeholder:"XXXXXXXXXX",className:"w-full",...r})}),e.jsx(x,{})]})})]})]})})]}),Q=({control:s})=>e.jsxs(j,{children:[e.jsx(g,{children:e.jsx(p,{children:"Charges"})}),e.jsx(b,{children:e.jsxs("div",{className:"grid  gap-6",children:[e.jsx(o,{control:s,name:"rate",render:({field:r})=>e.jsxs(l,{children:[e.jsx(c,{className:"text-primary mt-2",children:"Rate"}),e.jsx(m,{children:e.jsx(i,{placeholder:"0.00",className:"w-full",type:"number",step:.01,value:r.value,onChange:r.onChange,onBlur:r.onBlur,onWheel:h=>{h.currentTarget.blur()}})}),e.jsx(x,{})]})}),e.jsx(o,{control:s,name:"odaCharge",render:({field:r})=>e.jsxs(l,{children:[e.jsx(c,{className:"text-primary mt-2",children:"ODA Charge"}),e.jsx(m,{children:e.jsx(i,{placeholder:"0.00",className:"w-full",type:"number",step:.01,value:r.value,onChange:r.onChange,onBlur:r.onBlur,onWheel:h=>{h.currentTarget.blur()}})}),e.jsx(x,{})]})})]})})]}),Z=({control:s})=>e.jsxs(j,{children:[e.jsx(g,{children:e.jsx(p,{children:"TAT"})}),e.jsx(b,{children:e.jsx("div",{className:"grid  gap-6",children:e.jsx(o,{control:s,name:"tat",render:({field:r})=>e.jsxs(l,{children:[e.jsx(c,{className:"text-primary mt-2",children:"Turn Around Time"}),e.jsx(m,{children:e.jsx(i,{placeholder:"0",className:"w-full",type:"number",step:1,value:r.value,onChange:r.onChange,onBlur:r.onBlur,onWheel:h=>{h.currentTarget.blur()}})}),e.jsx(x,{})]})})})})]}),J=({initialData:s})=>e.jsxs(j,{children:[e.jsxs(g,{children:[e.jsx(p,{children:"Delete Distributor"}),e.jsx(w,{children:"Permanently delete distributor"})]}),e.jsx(b,{children:e.jsx(H,{name:s.name,id:s.id,children:e.jsxs(f,{size:"sm",variant:"destructive",type:"button",children:[e.jsx(E,{className:"w-4 h-4 mr-2"})," Delete"]})})})]}),F=d.optional(d.string()).refine(s=>!s||s===""?!0:parseFloat(s)>=0,{message:"Must be greater than or equal to zero"}).refine(s=>s&&/^\d+(\.\d{1,2})?$/.test(s),{message:"Must be up to 2 decimal places"}).default("0"),K=d.string().refine(s=>s===""?!0:/^[6789]\d{9}$/.test(s),{message:"Invalid Indian phone number format"}),Y=d.object({name:d.string({required_error:"Distributor name is required"}).min(1,{message:"Distributor name is required"}),destination:d.string({required_error:"Distributor destination is required"}).min(1,{message:"Distributor destination is required"}),address:d.string({required_error:"Distributor address is required"}).min(1,{message:"Distributor address is required"}),tat:d.optional(d.string()).nullable(),state:d.optional(d.string()).nullable(),email:d.optional(d.string()).nullable(),phone:d.optional(K).nullable(),rate:F,odaCharge:F}),se=({initialData:s})=>{const r=X(),[h]=z(),[T]=I(),N=!!s,t=_({resolver:P(Y),defaultValues:{tat:`${s==null?void 0:s.tat}`||null,phone:(s==null?void 0:s.phone)||null,email:(s==null?void 0:s.email)||null,state:(s==null?void 0:s.state)||null,rate:s?`${s==null?void 0:s.rate}`:"0.00",odaCharge:s?`${s==null?void 0:s.odaCharge}`:"0.00",address:(s==null?void 0:s.address)||"",name:(s==null?void 0:s.name)||"",destination:(s==null?void 0:s.destination)||""},mode:"onChange",reValidateMode:"onChange",criteriaMode:"firstError",shouldFocusError:!0,shouldUnregister:!0});async function q(a){console.log("submit"),console.log(a),N?await B(a):await A(a)}const C=a=>{const{message:n}=a==null?void 0:a.data;n&&Object.keys(n).map(y=>{t.setError(y,{message:n[y][0],type:"server"})})},A=async a=>{try{const n=await h(a).unwrap();u.success("Distributor created"),r("/distributors"),t.reset()}catch(n){(n==null?void 0:n.status)===400?(u.error("Invalid data: Please review and correct the form."),C(n)):u.error("Something went wrong")}},B=async a=>{try{const n=await T({id:s==null?void 0:s.id,values:a}).unwrap();u.success("Distributor updated successfully")}catch(n){(n==null?void 0:n.status)===400?(u.error("Invalid data: Please review and correct the form."),C(n)):u.error("Something went wrong")}},v=()=>r(".."),M=()=>{N?t.reset():v()};return e.jsx("div",{className:"relative mx-auto p-4 lg:p-6 max-w-7xl grid auto-rows-max gap-4 animate-in",children:e.jsx($,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(q),children:[t.formState.isLoading||t.formState.isSubmitting&&e.jsx("div",{className:"absolute -left-2 z-30 w-full h-full bg-transparent backdrop-blur-sm flex py-72 justify-center",children:e.jsx(O,{})}),e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsxs("div",{className:"flex items-center gap-4 py-2",children:[e.jsx(f,{onClick:v,variant:"outline",size:"icon",className:"h-7 w-7",type:"button",children:e.jsx(R,{className:"h-4 w-4"})}),s?e.jsxs("h1",{className:"flex gap-2 shrink-0 whitespace-nowrap text-xl font-semibold tracking-tight sm:grow-0 text-ellipsis",children:[e.jsx(S,{})," Distributor ",e.jsx(W,{})," ",s.id]}):e.jsxs("h1",{className:"flex items-center gap-2 shrink-0 whitespace-nowrap text-xl font-semibold tracking-tight sm:grow-0 text-ellipsis",children:[e.jsx(S,{})," Add Distributor"]})]}),e.jsxs("div",{className:"flex items-center gap-4 py-2",children:[e.jsx(f,{onClick:M,variant:"outline",size:"sm",type:"button",children:"Discard"}),e.jsxs(f,{type:"submit",variant:"orange",size:"sm",disabled:t.formState.isSubmitting||!t.formState.touchedFields,children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Save"]})]})]}),e.jsxs("div",{className:"mt-5 grid gap-4  lg:grid-cols-3 lg:gap-8",children:[e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 lg:col-span-2 lg:gap-8",children:[e.jsx(L,{control:t.control}),e.jsx(V,{control:t.control}),N&&s&&e.jsx(J,{initialData:s}),e.jsx("div",{className:"grid  lg:grid-cols-2 gap-4"})]}),e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 lg:gap-8",children:[e.jsx(Z,{control:t.control}),e.jsx(Q,{control:t.control}),e.jsx(U,{control:t.control})]})]})]})})})};export{se as D};
