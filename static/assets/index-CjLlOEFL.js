import{c as A,j as e,B as f,I as X,as as I,at as z,L as E,ak as S,M as u}from"./index-D023Ew-Q.js";import{F as a,a as c,b as l,c as m,d as i,T as L,f as _,z as d,u as P,t as $,e as H,S as R,H as O}from"./spinner-akWaBqIC.js";import{C as j,a as g,b as p,c as w,d as b}from"./alert-dialog-BTaYzCtj.js";import{I as x}from"./input-Do_bMhuR.js";import{D as V}from"./delete-modal-vvURdoyK.js";/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=A("SquareCheckBig",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]),U=({control:s})=>e.jsxs(j,{children:[e.jsxs(g,{children:[e.jsx(p,{children:"Basic Details"}),e.jsx(w,{children:"Distributor details"})]}),e.jsx(b,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsx(a,{control:s,name:"name",render:({field:r})=>e.jsxs(c,{children:[e.jsx(l,{className:"text-primary",children:"Name"}),e.jsx(m,{children:e.jsx(x,{placeholder:"Enter full name",className:"w-full",...r})}),e.jsx(i,{})]})}),e.jsx(a,{control:s,name:"destination",render:({field:r})=>e.jsxs(c,{children:[e.jsx(l,{className:"text-primary",children:"Destination"}),e.jsx(m,{children:e.jsx(x,{placeholder:"e.g. Guwahati",className:"w-full",...r})}),e.jsx(i,{})]})})]})})]}),G=({control:s})=>e.jsxs(j,{children:[e.jsx(g,{children:e.jsx(p,{children:"Email"})}),e.jsx(b,{children:e.jsx("div",{className:"grid gap-6",children:e.jsx(a,{control:s,name:"email",render:({field:r})=>e.jsxs(c,{children:[e.jsx(l,{className:"text-primary",children:"Email"}),e.jsx(m,{children:e.jsx(x,{placeholder:"e.g. distributor@domain.com",className:"w-full",type:"email",...r})}),e.jsx(i,{})]})})})})]}),J=({control:s})=>e.jsxs(j,{children:[e.jsxs(g,{children:[e.jsx(p,{children:"Address"}),e.jsx(w,{children:"Distributor office address"})]}),e.jsx(b,{children:e.jsxs("div",{className:"grid gap-6",children:[e.jsx(a,{control:s,name:"address",render:({field:r})=>e.jsxs(c,{className:"grid gap-3 flex-1",children:[e.jsx(l,{className:"text-primary",children:"Office Address"}),e.jsx(m,{children:e.jsx(L,{value:r.value,onChange:r.onChange})}),e.jsx(i,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsx(a,{control:s,name:"state",render:({field:r})=>e.jsxs(c,{children:[e.jsx(l,{className:"text-primary",children:"State"}),e.jsx(m,{children:e.jsx(x,{placeholder:"e.g. Assam",className:"w-full",...r})}),e.jsx(i,{})]})}),e.jsx(a,{control:s,name:"phone",render:({field:r})=>e.jsxs(c,{children:[e.jsx(l,{className:"text-primary",children:"Phone Number"}),e.jsx(m,{children:e.jsx(x,{placeholder:"XXXXXXXXXX",className:"w-full",...r})}),e.jsx(i,{})]})})]})]})})]}),K=({control:s})=>e.jsxs(j,{children:[e.jsx(g,{children:e.jsx(p,{children:"Charges"})}),e.jsx(b,{children:e.jsxs("div",{className:"grid  gap-6",children:[e.jsx(a,{control:s,name:"rate",render:({field:r})=>e.jsxs(c,{children:[e.jsx(l,{className:"text-primary mt-2",children:"Rate"}),e.jsx(m,{children:e.jsx(x,{placeholder:"0.00",className:"w-full",type:"number",step:.01,value:r.value,onChange:r.onChange,onBlur:r.onBlur,onWheel:h=>{h.currentTarget.blur()}})}),e.jsx(i,{})]})}),e.jsx(a,{control:s,name:"odaCharge",render:({field:r})=>e.jsxs(c,{children:[e.jsx(l,{className:"text-primary mt-2",children:"ODA Charge"}),e.jsx(m,{children:e.jsx(x,{placeholder:"0.00",className:"w-full",type:"number",step:.01,value:r.value,onChange:r.onChange,onBlur:r.onBlur,onWheel:h=>{h.currentTarget.blur()}})}),e.jsx(i,{})]})})]})})]}),Q=({control:s})=>e.jsxs(j,{children:[e.jsx(g,{children:e.jsx(p,{children:"TAT"})}),e.jsx(b,{children:e.jsx("div",{className:"grid  gap-6",children:e.jsx(a,{control:s,name:"tat",render:({field:r})=>e.jsxs(c,{children:[e.jsx(l,{className:"text-primary mt-2",children:"Turn Around Time"}),e.jsx(m,{children:e.jsx(x,{placeholder:"0",className:"w-full",type:"number",step:1,value:r.value,onChange:r.onChange,onBlur:r.onBlur,onWheel:h=>{h.currentTarget.blur()}})}),e.jsx(i,{})]})})})})]}),Y=({initialData:s})=>e.jsxs(j,{children:[e.jsxs(g,{children:[e.jsx(p,{children:"Delete Distributor"}),e.jsx(w,{children:"Permanently delete distributor"})]}),e.jsx(b,{children:e.jsx(V,{name:s.name,id:s.id,children:e.jsxs(f,{size:"sm",variant:"destructive",type:"button",children:[e.jsx(_,{className:"w-4 h-4 mr-2"})," Delete"]})})})]}),k=d.optional(d.string()).refine(s=>!s||s===""?!0:parseFloat(s)>=0,{message:"Must be greater than or equal to zero"}).refine(s=>s&&/^\d+(\.\d{1,2})?$/.test(s),{message:"Must be up to 2 decimal places"}).default("0"),Z=d.string().refine(s=>s===""?!0:/^[6789]\d{9}$/.test(s),{message:"Invalid Indian phone number format"}),D=d.object({name:d.string({required_error:"Distributor name is required"}).min(1,{message:"Distributor name is required"}),destination:d.string({required_error:"Distributor destination is required"}).min(1,{message:"Distributor destination is required"}),address:d.string({required_error:"Distributor address is required"}).min(1,{message:"Distributor address is required"}),tat:d.optional(d.string()).nullable(),state:d.optional(d.string()).nullable(),email:d.optional(d.string()).nullable(),phone:d.optional(Z).nullable(),rate:k,odaCharge:k}),de=({initialData:s})=>{const r=X(),[h]=I(),[q]=z(),N=!!s,t=P({resolver:$(D),defaultValues:{tat:`${s==null?void 0:s.tat}`||null,phone:(s==null?void 0:s.phone)||null,email:(s==null?void 0:s.email)||null,state:(s==null?void 0:s.state)||null,rate:s?`${s==null?void 0:s.rate}`:"0.00",odaCharge:s?`${s==null?void 0:s.odaCharge}`:"0.00",address:(s==null?void 0:s.address)||"",name:(s==null?void 0:s.name)||"",destination:(s==null?void 0:s.destination)||""},mode:"onChange",reValidateMode:"onChange",criteriaMode:"firstError",shouldFocusError:!0,shouldUnregister:!0});async function B(o){console.log("submit"),console.log(o),N?await M(o):await F(o)}const C=o=>{const{message:n}=o==null?void 0:o.data;n&&Object.keys(n).map(y=>{t.setError(y,{message:n[y][0],type:"server"})})},F=async o=>{try{const n=await h(o).unwrap();u.success("Distributor created"),r("/distributors"),t.reset()}catch(n){(n==null?void 0:n.status)===400?(u.error("Invalid data: Please review and correct the form."),C(n)):u.error("Something went wrong")}},M=async o=>{try{const n=await q({id:s==null?void 0:s.id,values:o}).unwrap();u.success("Distributor updated successfully")}catch(n){(n==null?void 0:n.status)===400?(u.error("Invalid data: Please review and correct the form."),C(n)):u.error("Something went wrong")}},v=()=>r(".."),T=()=>{N?t.reset():v()};return e.jsx("div",{className:"relative mx-auto p-4 lg:p-6 max-w-7xl grid auto-rows-max gap-4 animate-in",children:e.jsx(H,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(B),children:[t.formState.isLoading||t.formState.isSubmitting&&e.jsx("div",{className:"absolute -left-2 z-30 w-full h-full bg-transparent backdrop-blur-sm flex py-72 justify-center",children:e.jsx(R,{})}),e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsxs("div",{className:"flex items-center gap-4 py-2",children:[e.jsx(f,{onClick:v,variant:"outline",size:"icon",className:"h-7 w-7",type:"button",children:e.jsx(E,{className:"h-4 w-4"})}),s?e.jsxs("h1",{className:"flex gap-2 shrink-0 whitespace-nowrap text-xl font-semibold tracking-tight sm:grow-0 text-ellipsis",children:[e.jsx(S,{})," Distributor ",e.jsx(O,{})," ",s.id]}):e.jsxs("h1",{className:"flex items-center gap-2 shrink-0 whitespace-nowrap text-xl font-semibold tracking-tight sm:grow-0 text-ellipsis",children:[e.jsx(S,{})," Add Distributor"]})]}),e.jsxs("div",{className:"flex items-center gap-4 py-2",children:[e.jsx(f,{onClick:T,variant:"outline",size:"sm",type:"button",children:"Discard"}),e.jsxs(f,{type:"submit",variant:"orange",size:"sm",disabled:t.formState.isSubmitting||!t.formState.touchedFields,children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),"Save"]})]})]}),e.jsxs("div",{className:"mt-5 grid gap-4  lg:grid-cols-3 lg:gap-8",children:[e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 lg:col-span-2 lg:gap-8",children:[e.jsx(U,{control:t.control}),e.jsx(J,{control:t.control}),N&&s&&e.jsx(Y,{initialData:s}),e.jsx("div",{className:"grid  lg:grid-cols-2 gap-4"})]}),e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 lg:gap-8",children:[e.jsx(Q,{control:t.control}),e.jsx(K,{control:t.control}),e.jsx(G,{control:t.control})]})]})]})})})};export{de as D};
