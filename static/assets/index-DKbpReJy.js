import{j as e,B as j,b as q,c as z,d as A,C as E,N as S,_ as g}from"./index-D3MpGbMR.js";import{z as c}from"./index-DXqQCM1T.js";import{F as l,a as o,b as t,c as m,d as h,T as I,e as T,u as _,t as $,f as H,S as L,H as O}from"./textarea-jcf1xEN7.js";import{C as p,a as i,b as C,c as w,d as f,I as u}from"./index-z4fhoOdL.js";import{D as R}from"./delete-modal-D66pdwQ4.js";import{S as W}from"./square-check-big-BWZHRSR5.js";const U=({control:s})=>e.jsxs(p,{children:[e.jsxs(i,{children:[e.jsx(C,{children:"Basic Details"}),e.jsx(w,{children:"Channel partner details"})]}),e.jsx(f,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsx(l,{control:s,name:"name",render:({field:r})=>e.jsxs(o,{children:[e.jsx(t,{className:"text-primary",children:"Name"}),e.jsx(m,{children:e.jsx(u,{placeholder:"Enter full name",className:"w-full",...r})}),e.jsx(h,{})]})}),e.jsx(l,{control:s,name:"pincode",render:({field:r})=>e.jsxs(o,{children:[e.jsx(t,{className:"text-primary",children:"Pincode"}),e.jsx(m,{children:e.jsx(u,{type:"number",step:1,placeholder:"XXXXXXX",className:"w-full",...r})}),e.jsx(h,{})]})})]})})]}),V=({control:s})=>e.jsxs(p,{children:[e.jsxs(i,{children:[e.jsx(C,{children:"Address"}),e.jsx(w,{children:"Channel partner office address"})]}),e.jsx(f,{children:e.jsxs("div",{className:"grid gap-6",children:[e.jsx(l,{control:s,name:"address",render:({field:r})=>e.jsxs(o,{className:"grid gap-3 flex-1",children:[e.jsx(t,{className:"text-primary",children:"Office Address"}),e.jsx(m,{children:e.jsx(I,{value:r.value,onChange:r.onChange})}),e.jsx(h,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsx(l,{control:s,name:"email",render:({field:r})=>e.jsxs(o,{children:[e.jsx(t,{className:"text-primary",children:"Email"}),e.jsx(m,{children:e.jsx(u,{placeholder:"e.g. cp@domain.com",className:"w-full",...r})}),e.jsx(h,{})]})}),e.jsx(l,{control:s,name:"phone",render:({field:r})=>e.jsxs(o,{children:[e.jsx(t,{className:"text-primary",children:"Phone Number"}),e.jsx(m,{children:e.jsx(u,{placeholder:"XXXXXXXXXX",className:"w-full",...r})}),e.jsx(h,{})]})})]})]})})]}),G=({control:s})=>e.jsxs(p,{children:[e.jsx(i,{children:e.jsx(C,{children:"Charges"})}),e.jsx(f,{children:e.jsxs("div",{className:"grid  gap-6",children:[e.jsx(l,{control:s,name:"fixedCharge",render:({field:r})=>e.jsxs(o,{children:[e.jsx(t,{className:"text-primary mt-2",children:"Fixed Charges"}),e.jsx(m,{children:e.jsx(u,{placeholder:"0.00",className:"w-full",type:"number",step:.01,value:r.value,onChange:r.onChange,onBlur:r.onBlur,onWheel:x=>{x.currentTarget.blur()}})}),e.jsx(h,{})]})}),e.jsx(l,{control:s,name:"odaCharge",render:({field:r})=>e.jsxs(o,{children:[e.jsx(t,{className:"text-primary mt-2",children:"ODA Charges"}),e.jsx(m,{children:e.jsx(u,{placeholder:"0.00",className:"w-full",type:"number",step:.01,value:r.value,onChange:r.onChange,onBlur:r.onBlur,onWheel:x=>{x.currentTarget.blur()}})}),e.jsx(h,{})]})}),e.jsx(l,{control:s,name:"miscCharge",render:({field:r})=>e.jsxs(o,{children:[e.jsx(t,{className:"text-primary mt-2",children:"Miscellaneous Charges"}),e.jsx(m,{children:e.jsx(u,{placeholder:"0.00",className:"w-full",type:"number",step:.01,value:r.value,onChange:r.onChange,onBlur:r.onBlur,onWheel:x=>{x.currentTarget.blur()}})}),e.jsx(h,{})]})})]})})]}),J=({initialData:s})=>e.jsxs(p,{children:[e.jsxs(i,{children:[e.jsx(C,{children:"Delete Channel Partner"}),e.jsx(w,{children:"Permanently delete channel partner"})]}),e.jsx(f,{children:e.jsx(R,{name:s.name,id:s.id,children:e.jsxs(j,{size:"sm",variant:"destructive",type:"button",children:[e.jsx(T,{className:"w-4 h-4 mr-2"})," Delete"]})})})]}),b=c.optional(c.string()).refine(s=>!s||s===""?!0:parseFloat(s)>=0,{message:"Must be greater than or equal to zero"}).refine(s=>s&&/^\d+(\.\d{1,2})?$/.test(s),{message:"Must be up to 2 decimal places"}).default("0"),K=c.string().refine(s=>s===""?!0:/^[6789]\d{9}$/.test(s),{message:"Invalid Indian phone number format"}),Q=c.object({name:c.string({required_error:"Channel Partner name is required"}).min(1,{message:"Channel Partner name is required"}),pincode:c.optional(c.string().min(1,{message:"Pincode is required"}).max(7,{message:"Pincode cannot be more than 7 digits"})),address:c.string({required_error:"Channel Partner Address is required"}).min(1,{message:"Channel Partner address is required"}),email:c.optional(c.string()).nullable(),phone:c.optional(K).nullable(),odaCharge:b,fixedCharge:b,miscCharge:b}),ne=({initialData:s})=>{const r=q(),[x]=z(),[X]=A(),N=!!s,a=_({resolver:$(Q),defaultValues:{phone:(s==null?void 0:s.phone)||null,email:(s==null?void 0:s.email)||null,odaCharge:s?`${s==null?void 0:s.odaCharge}`:"0.00",miscCharge:s?`${s==null?void 0:s.miscCharge}`:"0.00",fixedCharge:s?`${s==null?void 0:s.fixedCharge}`:"0.00",address:(s==null?void 0:s.address)||"",name:(s==null?void 0:s.name)||"",pincode:(s==null?void 0:s.pincode)||void 0},mode:"onChange",reValidateMode:"onChange",criteriaMode:"firstError",shouldFocusError:!0,shouldUnregister:!0});async function F(d){console.log("submit"),console.log(d),N?await k(d):await M(d)}const v=d=>{const{message:n}=d==null?void 0:d.data;n&&Object.keys(n).map(P=>{a.setError(P,{message:n[P][0],type:"server"})})},M=async d=>{try{const n=await x(d).unwrap();g.success("Channel partner created"),r("/channel-partners"),a.reset()}catch(n){(n==null?void 0:n.status)===400?(g.error("Invalid data: Please review and correct the form."),v(n)):g.error("Something went wrong")}},k=async d=>{try{const n=await X({id:s==null?void 0:s.id,values:d}).unwrap();g.success("Channel partner updated successfully")}catch(n){(n==null?void 0:n.status)===400?(g.error("Invalid data: Please review and correct the form."),v(n)):g.error("Something went wrong")}},y=()=>r(".."),B=()=>{N?a.reset():y()};return e.jsx("div",{className:"relative mx-auto p-4 lg:p-6 max-w-7xl grid auto-rows-max gap-4 animate-in",children:e.jsx(H,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(F),children:[a.formState.isLoading||a.formState.isSubmitting&&e.jsx("div",{className:"absolute -left-2 z-30 w-full h-full bg-transparent backdrop-blur-sm flex py-72 justify-center",children:e.jsx(L,{})}),e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsxs("div",{className:"flex items-center gap-4 py-2",children:[e.jsx(j,{onClick:y,variant:"outline",size:"icon",className:"h-7 w-7",type:"button",children:e.jsx(E,{className:"h-4 w-4"})}),s?e.jsxs("h1",{className:"flex gap-2 shrink-0 whitespace-nowrap text-xl font-semibold tracking-tight sm:grow-0 text-ellipsis",children:[e.jsx(S,{})," Channel Partner ",e.jsx(O,{})," ",s.name]}):e.jsxs("h1",{className:"flex items-center gap-2 shrink-0 whitespace-nowrap text-xl font-semibold tracking-tight sm:grow-0 text-ellipsis",children:[e.jsx(S,{className:"size-5"})," Add Channel Partner"]})]}),e.jsxs("div",{className:"flex items-center gap-4 py-2",children:[e.jsx(j,{onClick:B,variant:"outline",size:"sm",type:"button",children:"Discard"}),e.jsxs(j,{type:"submit",variant:"orange",size:"sm",disabled:a.formState.isSubmitting||!a.formState.touchedFields,children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),"Save"]})]})]}),e.jsxs("div",{className:"mt-5 grid gap-4  lg:grid-cols-3 lg:gap-8",children:[e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 lg:col-span-2 lg:gap-8",children:[e.jsx(U,{control:a.control}),e.jsx(V,{control:a.control}),e.jsx("div",{className:"grid  lg:grid-cols-2 gap-4"})]}),e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 lg:gap-8",children:[e.jsx(G,{control:a.control}),N&&s&&e.jsx(J,{initialData:s})]})]})]})})})};export{ne as C};
