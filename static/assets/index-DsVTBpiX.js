import{j as e,B as f,b as k,a1 as X,a2 as E,C as z,_ as h}from"./index-D3MpGbMR.js";import{F as l,a,b as c,c as m,d as i,T as I,e as _,u as P,t as $,f as R,S as H,H as L}from"./textarea-jcf1xEN7.js";import{z as d}from"./index-DXqQCM1T.js";import{C as j,a as g,b as p,c as w,d as b,I as x}from"./index-z4fhoOdL.js";import{D as O,S}from"./delete-modal-BZG89K8v.js";import{S as W}from"./square-check-big-BWZHRSR5.js";const U=({control:s})=>e.jsxs(j,{children:[e.jsxs(g,{children:[e.jsx(p,{children:"Basic Details"}),e.jsx(w,{children:"Distributor details"})]}),e.jsx(b,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsx(l,{control:s,name:"name",render:({field:r})=>e.jsxs(a,{children:[e.jsx(c,{className:"text-primary",children:"Name"}),e.jsx(m,{children:e.jsx(x,{placeholder:"Enter full name",className:"w-full",...r})}),e.jsx(i,{})]})}),e.jsx(l,{control:s,name:"destination",render:({field:r})=>e.jsxs(a,{children:[e.jsx(c,{className:"text-primary",children:"Destination"}),e.jsx(m,{children:e.jsx(x,{placeholder:"e.g. Guwahati",className:"w-full",...r})}),e.jsx(i,{})]})})]})})]}),V=({control:s})=>e.jsxs(j,{children:[e.jsx(g,{children:e.jsx(p,{children:"Email"})}),e.jsx(b,{children:e.jsx("div",{className:"grid gap-6",children:e.jsx(l,{control:s,name:"email",render:({field:r})=>e.jsxs(a,{children:[e.jsx(c,{className:"text-primary",children:"Email"}),e.jsx(m,{children:e.jsx(x,{placeholder:"e.g. distributor@domain.com",className:"w-full",type:"email",...r})}),e.jsx(i,{})]})})})})]}),G=({control:s})=>e.jsxs(j,{children:[e.jsxs(g,{children:[e.jsx(p,{children:"Address"}),e.jsx(w,{children:"Distributor office address"})]}),e.jsx(b,{children:e.jsxs("div",{className:"grid gap-6",children:[e.jsx(l,{control:s,name:"address",render:({field:r})=>e.jsxs(a,{className:"grid gap-3 flex-1",children:[e.jsx(c,{className:"text-primary",children:"Office Address"}),e.jsx(m,{children:e.jsx(I,{value:r.value,onChange:r.onChange})}),e.jsx(i,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsx(l,{control:s,name:"state",render:({field:r})=>e.jsxs(a,{children:[e.jsx(c,{className:"text-primary",children:"State"}),e.jsx(m,{children:e.jsx(x,{placeholder:"e.g. Assam",className:"w-full",...r})}),e.jsx(i,{})]})}),e.jsx(l,{control:s,name:"phone",render:({field:r})=>e.jsxs(a,{children:[e.jsx(c,{className:"text-primary",children:"Phone Number"}),e.jsx(m,{children:e.jsx(x,{placeholder:"XXXXXXXXXX",className:"w-full",...r})}),e.jsx(i,{})]})})]})]})})]}),J=({control:s})=>e.jsxs(j,{children:[e.jsx(g,{children:e.jsx(p,{children:"Charges"})}),e.jsx(b,{children:e.jsxs("div",{className:"grid  gap-6",children:[e.jsx(l,{control:s,name:"rate",render:({field:r})=>e.jsxs(a,{children:[e.jsx(c,{className:"text-primary mt-2",children:"Rate"}),e.jsx(m,{children:e.jsx(x,{placeholder:"0.00",className:"w-full",type:"number",step:.01,value:r.value,onChange:r.onChange,onBlur:r.onBlur,onWheel:u=>{u.currentTarget.blur()}})}),e.jsx(i,{})]})}),e.jsx(l,{control:s,name:"odaCharge",render:({field:r})=>e.jsxs(a,{children:[e.jsx(c,{className:"text-primary mt-2",children:"ODA Charge"}),e.jsx(m,{children:e.jsx(x,{placeholder:"0.00",className:"w-full",type:"number",step:.01,value:r.value,onChange:r.onChange,onBlur:r.onBlur,onWheel:u=>{u.currentTarget.blur()}})}),e.jsx(i,{})]})})]})})]}),K=({control:s})=>e.jsxs(j,{children:[e.jsx(g,{children:e.jsx(p,{children:"TAT"})}),e.jsx(b,{children:e.jsx("div",{className:"grid  gap-6",children:e.jsx(l,{control:s,name:"tat",render:({field:r})=>e.jsxs(a,{children:[e.jsx(c,{className:"text-primary mt-2",children:"Turn Around Time"}),e.jsx(m,{children:e.jsx(x,{placeholder:"0",className:"w-full",type:"number",step:1,value:r.value,onChange:r.onChange,onBlur:r.onBlur,onWheel:u=>{u.currentTarget.blur()}})}),e.jsx(i,{})]})})})})]}),Q=({initialData:s})=>e.jsxs(j,{children:[e.jsxs(g,{children:[e.jsx(p,{children:"Delete Distributor"}),e.jsx(w,{children:"Permanently delete distributor"})]}),e.jsx(b,{children:e.jsx(O,{name:s.name,id:s.id,children:e.jsxs(f,{size:"sm",variant:"destructive",type:"button",children:[e.jsx(_,{className:"w-4 h-4 mr-2"})," Delete"]})})})]}),F=d.optional(d.string()).refine(s=>!s||s===""?!0:parseFloat(s)>=0,{message:"Must be greater than or equal to zero"}).refine(s=>s&&/^\d+(\.\d{1,2})?$/.test(s),{message:"Must be up to 2 decimal places"}).default("0"),Y=d.string().refine(s=>s===""?!0:/^[6789]\d{9}$/.test(s),{message:"Invalid Indian phone number format"}),Z=d.object({name:d.string({required_error:"Distributor name is required"}).min(1,{message:"Distributor name is required"}),destination:d.string({required_error:"Distributor destination is required"}).min(1,{message:"Distributor destination is required"}),address:d.string({required_error:"Distributor address is required"}).min(1,{message:"Distributor address is required"}),tat:d.optional(d.string()).nullable(),state:d.optional(d.string()).nullable(),email:d.optional(d.string()).nullable(),phone:d.optional(Y).nullable(),rate:F,odaCharge:F}),de=({initialData:s})=>{const r=k(),[u]=X(),[T]=E(),N=!!s,t=P({resolver:$(Z),defaultValues:{tat:`${s==null?void 0:s.tat}`||null,phone:(s==null?void 0:s.phone)||null,email:(s==null?void 0:s.email)||null,state:(s==null?void 0:s.state)||null,rate:s?`${s==null?void 0:s.rate}`:"0.00",odaCharge:s?`${s==null?void 0:s.odaCharge}`:"0.00",address:(s==null?void 0:s.address)||"",name:(s==null?void 0:s.name)||"",destination:(s==null?void 0:s.destination)||""},mode:"onChange",reValidateMode:"onChange",criteriaMode:"firstError",shouldFocusError:!0,shouldUnregister:!0});async function q(o){console.log("submit"),console.log(o),N?await A(o):await B(o)}const C=o=>{const{message:n}=o==null?void 0:o.data;n&&Object.keys(n).map(y=>{t.setError(y,{message:n[y][0],type:"server"})})},B=async o=>{try{const n=await u(o).unwrap();h.success("Distributor created"),r("/distributors"),t.reset()}catch(n){(n==null?void 0:n.status)===400?(h.error("Invalid data: Please review and correct the form."),C(n)):h.error("Something went wrong")}},A=async o=>{try{const n=await T({id:s==null?void 0:s.id,values:o}).unwrap();h.success("Distributor updated successfully")}catch(n){(n==null?void 0:n.status)===400?(h.error("Invalid data: Please review and correct the form."),C(n)):h.error("Something went wrong")}},v=()=>r(".."),M=()=>{N?t.reset():v()};return e.jsx("div",{className:"relative mx-auto p-4 lg:p-6 max-w-7xl grid auto-rows-max gap-4 animate-in",children:e.jsx(R,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(q),children:[t.formState.isLoading||t.formState.isSubmitting&&e.jsx("div",{className:"absolute -left-2 z-30 w-full h-full bg-transparent backdrop-blur-sm flex py-72 justify-center",children:e.jsx(H,{})}),e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsxs("div",{className:"flex items-center gap-4 py-2",children:[e.jsx(f,{onClick:v,variant:"outline",size:"icon",className:"h-7 w-7",type:"button",children:e.jsx(z,{className:"h-4 w-4"})}),s?e.jsxs("h1",{className:"flex gap-2 shrink-0 whitespace-nowrap text-xl font-semibold tracking-tight sm:grow-0 text-ellipsis",children:[e.jsx(S,{})," Distributor ",e.jsx(L,{})," ",s.id]}):e.jsxs("h1",{className:"flex items-center gap-2 shrink-0 whitespace-nowrap text-xl font-semibold tracking-tight sm:grow-0 text-ellipsis",children:[e.jsx(S,{})," Add Distributor"]})]}),e.jsxs("div",{className:"flex items-center gap-4 py-2",children:[e.jsx(f,{onClick:M,variant:"outline",size:"sm",type:"button",children:"Discard"}),e.jsxs(f,{type:"submit",variant:"orange",size:"sm",disabled:t.formState.isSubmitting||!t.formState.touchedFields,children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),"Save"]})]})]}),e.jsxs("div",{className:"mt-5 grid gap-4  lg:grid-cols-3 lg:gap-8",children:[e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 lg:col-span-2 lg:gap-8",children:[e.jsx(U,{control:t.control}),e.jsx(G,{control:t.control}),N&&s&&e.jsx(Q,{initialData:s}),e.jsx("div",{className:"grid  lg:grid-cols-2 gap-4"})]}),e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 lg:gap-8",children:[e.jsx(K,{control:t.control}),e.jsx(J,{control:t.control}),e.jsx(V,{control:t.control})]})]})]})})})};export{de as D};
